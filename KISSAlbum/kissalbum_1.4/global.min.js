jQuery(function(b){function e(p){n=p.feed.author[0].name.$t;document.title=n+"'s Photo Album";b("#hd_title h1").text(n+"'s Photo Album");r=" &gt; "+o;b("#gh_tips p").append(r);var f=p.feed.entry.length;if(f>0){b(".album_view").append('<ul class="album_list"></ul>');for(var d=0;d<f;d++)a(p.feed.entry[d].gphoto$id.$t,p.feed.entry[d].media$group.media$thumbnail[0].url,p.feed.entry[d].title.$t,p.feed.entry[d].summary.$t,d+1,f,h)}}function a(b,a,d,y,e,k,g){var c=new Image;c.id=b;c.src=a;c.title=d;c.summary=
y;c.num=k;c.complete?g.call(c):c.onload=function(){g.call(c)}}function h(){w++;w==1&&b(".album_view .loading").remove();var a="";a+='<li class="album_item">';a+='<a href="index.html?userid='+o+"&albumid="+this.id+'" title="'+this.summary+'">';a+='<img src="'+this.src+'" alt="'+this.summary+'" />';this.title!=""&&(a+="<span>"+this.title+"</span>");a+="</a>";a+="</li>";b(".album_view .album_list").append(a)}function m(a){n=a.feed.author[0].name.$t;document.title=n+"'s Photo Album";b("#hd_title h1").text(n+
"'s Photo Album");if(a.feed.title.$t!=""){r=' &gt; <a href="index.html?userid='+o+'" title="'+n+"'s Album\">"+o+"</a> &gt; "+a.feed.title.$t;var f="<h2>"+a.feed.title.$t+"</h2>";b("#gh_tips p").append(r);b(".album").prepend(f)}a.feed.subtitle.$t!=""&&b(".album_intro").html("<p>"+a.feed.subtitle.$t+"</p>");i=a.feed.entry.length;if(i>0){b(".photo_window").html('<ul class="photo_bar"></ul>').children(".photo_bar").width(83*i);b(".photo_view").append('<a class="photo_prev" href="#" title="\u4e0a\u4e00\u5f20 \u5feb\u6377\u952e:[&quot;H&quot;]\u6216\u8005[&quot;&larr;&quot;]" hidefocus="true"></a><a class="photo_next" href="#" title="\u4e0b\u4e00\u5f20 \u5feb\u6377\u952e:[&quot;L&quot;]\u6216\u8005[&quot;&rarr;&quot;]" hidefocus="true"></a><ul class="photo_list"></ul>');
for(f=0;f<i;f++){var d=a.feed.entry[f].gphoto$id.$t;z==d&&(v=f+1);g(a.feed.entry[f].media$group.media$thumbnail[0].url.replace(/\/s72\//,"/s74-c/"),a.feed.entry[f].summary.$t,f+1,d,j);var d=a.feed.entry[f].exif$tags,c=[];d.exif$model&&c.push(d.exif$model.$t);d.exif$fstop&&c.push("F/"+d.exif$fstop.$t);if(d.exif$exposure){var e=parseFloat(d.exif$exposure.$t);e<1&&(e="1/"+Math.round(1/e));c.push(e+"s")}d.exif$focallength&&c.push(Math.round(d.exif$focallength.$t)+"mm");d.exif$iso&&c.push("ISO"+d.exif$iso.$t);
d.exif$flash&&d.exif$flash.$t=="true"&&c.push("Flash");d.exif$time&&(e=new Date,e.setTime(parseInt(d.exif$time.$t)-288E5),c.push(e.toString()));d=c;s(a.feed.entry[f].media$group.media$thumbnail[0].url.replace(/\/s72\//,"/s"+k.photowidth+"/"),a.feed.entry[f].summary.$t,"",f+1,d,a.feed.entry[f].media$group.media$content[0].width,a.feed.entry[f].media$group.media$content[0].height,q)}}}function g(a,f,d,c,e){b(".photo_bar").append('<li id="photo_bar_'+d+'"><a href="#'+c+'" title="'+f+'" class="unready" hidefocus="true"><img src="images/loading_img_0.gif" alt="'+
f+'" /><span>'+d+"</span></a></li>");d==i&&(b(".photo_view").prev(".loading").remove(),b(".photo_preview").show().after('<div class="load_show"><div class="load_bar">loading</div><div class="load_photo"></div></div>'),b(".photo_bar").togglePhotos({defphoto:v,photonum:i,perphotos:Math.floor((k.pagewidth-67)/83)-1}));var g=new Image;g.src=a;g.title=f;g.index=d;g.complete?e.call(g):(g.onload=function(){e.call(g)},g.onerror=function(){})}function s(a,f,d,c,e,g,j,i){var h="";h+='<li class="photo_item" style="width: '+
k.pagewidth+'px;" id="photo_item_'+c+'">';h+='<div class="photo_show"><div class="loading">No: '+c+"</div></div>";h+='<div class="photo_intro">';h+="<p>"+e.join(", ")+"</p>";f!=""&&(h+="<h3>"+f+"</h3>");h+=d;h+="</div>";h+="</li>";b(".photo_list").append(h);var l=new Image;l.src=a;l.title=f;l.intro=d;l.index=c;l.width=g;l.height=j;l.complete?i.call(l):(l.onload=function(){i.call(l)},l.onerror=function(){})}function j(){x++;b(".load_bar").width(x*k.pagewidth/i);b(".photo_bar #photo_bar_"+this.index+
" img").attr("src",this.src)}function q(){t++;b("#photo_bar_"+this.index+" a").removeClass("unready");b(".load_photo").width(t*k.pagewidth/i);b(".load_bar").text("Loading "+t+"/"+i);b(".photo_list #photo_item_"+this.index+" .photo_show").html('<img src="'+this.src+'" alt="'+this.title+'" title="'+this.title+'" />');t==i&&b(".load_show").remove();this.index==(b(".photo_bar li a.active span").text()||v)&&b("#photo_item_"+this.index).setHeight()}var k={photowidth:960};k.pagewidth=k.photowidth+20;b("#gh_content, #header, #container").width(k.pagewidth);
b(".photo_window").width(k.pagewidth-74);b(".theme_item a").each(function(a){b(this).bind("click",function(){b("body").attr("id","theme_"+(a+1));b(this).parent().addClass("active").siblings(".theme_item").removeClass("active");b.cookie("theme_id",a+1,{expires:365});return!1})});var c=3,u=parseInt(b.cookie("theme_id"));u!=null&&u>0&&u<5&&(c=u);b(".theme_item a").eq(c-1).trigger("click");b("noscript").remove();b("a, input, select, button, textarea").live("focus",function(){b(this).addClass("onfocus")}).live("blur",
function(){b(this).removeClass("onfocus")});b(".a_user").each(function(){b(this).bind("focus",function(){b(this).val()==this.defaultValue&&b(this).val("")}).bind("blur",function(){b(this).val()==""&&b(this).val(this.defaultValue)}).bind("keydown",function(a){a.which==13&&b(this).next(".a_go").trigger("click")})});b(".a_go").each(function(){b(this).bind("click",function(){var a=b(this).prev(".a_user")[0].defaultValue,c=b(this).prev(".a_user").val();c==a||c==""?alert("\u8bf7\u8f93\u5165\u5e10\u53f7\uff01"):
window.location.href="index.html?userid="+c})});var w=0,v=1,i=1,x=0,t=0,z=location.hash.substring(1),o="",n="",r="",c=function(){for(var b={},a=location.search.substring(1).split("&"),d=0;d<a.length;d++){var c=a[d].indexOf("=");if(c!=-1){var e=a[d].substring(0,c),c=a[d].substring(c+1);b[e]=unescape(c)}}return b}();c.userid?(o=c.userid,b(".home,").hide(),b("#gh_tips, .theme_album").show(),c.albumid?(b(".album_view").remove(),b(".album").show(),b.ajax({url:"https://picasaweb.google.com/data/feed/api/user/"+
o+"/albumid/"+c.albumid+"?kind=photo&access=public&alt=json",dataType:"json",error:function(){alert("Album Date Error!");window.location.href="index.html"},success:m})):(b(".album").remove(),b(".album_view").show(),b.ajax({url:"https://picasaweb.google.com/data/feed/api/user/"+o+"?kind=album&access=public&alt=json",dataType:"json",error:function(){alert("User Date Error!");window.location.href="index.html"},success:e})),b(".theme_album a").bind("click",function(){b(".home").slideToggle();return!1})):
(b(".album, .album_view, .theme_album").remove(),b(".home").show());document.onkeydown=function(a){a=a||window.event;if(a.ctrlKey)switch(a.keyCode){case 37:b(".leftarrow").trigger("click");break;case 39:b(".rightarrow").trigger("click");break;case 38:b(".photo_bar li a:first").trigger("click");break;case 40:b(".photo_bar li a:last").trigger("click")}else switch(a.keyCode){case 37:case 72:b(".photo_prev").trigger("click");break;case 39:case 76:b(".photo_next").trigger("click");break;case 74:b(".rightarrow").trigger("click");
break;case 75:b(".leftarrow").trigger("click")}}});
jQuery.cookie=function(b,e,a){if(arguments.length>1&&(e===null||typeof e!=="object")){a=jQuery.extend({},a);if(e===null)a.expires=-1;if(typeof a.expires==="number"){var h=a.expires,m=a.expires=new Date;m.setDate(m.getDate()+h)}return document.cookie=[encodeURIComponent(b),"=",a.raw?String(e):encodeURIComponent(String(e)),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}a=e||{};m=a.raw?function(a){return a}:
decodeURIComponent;return(h=RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)").exec(document.cookie))?m(h[1]):null};
(function(b){b.fn.listHeight=function(){return this.each(function(){var e=0;b(this).children().each(function(){e=b(this).height()>e?b(this).height():e});b(this).children().height(e)})};b.fn.togglePhotos=function(e){var a={defphoto:1,photonum:0,photowidth:83,perphotos:10,movespeed:1E3,prevbtn:".leftarrow",nextbtn:".rightarrow",prevclass:"prevarrow",nextclass:"nextarrow",prevdiv:".photo_prev",nextdiv:".photo_next",fadeinspeed:400,fadeoutspeed:1E3,clicktag:"li a",itemsid:"#photo_item_",parentdiv:".album",
activeclass:"active",setevent:"click"};return this.each(function(){function h(b){q.stop(!0,!0).animate({left:-(b-1)*a.photowidth*a.perphotos},a.movespeed);j=b;m()}function m(){j>1?b(a.prevbtn).addClass(a.prevclass):b(a.prevbtn).removeClass(a.prevclass);j<s?b(a.nextbtn).addClass(a.nextclass):b(a.nextbtn).removeClass(a.nextclass)}e&&b.extend(a,e);var g=a.defphoto,s=Math.ceil(a.photonum/a.perphotos),j=Math.ceil(a.defphoto/a.perphotos);m();b(this).css("left","-"+a.photowidth*a.perphotos*(j-1)+"px");var q=
b(this);b(a.nextbtn).bind(a.setevent,function(){j<s&&h(j+1);return!1});b(a.prevbtn).bind(a.setevent,function(){j>1&&h(j-1);return!1});b(a.nextdiv).bind(a.setevent,function(){g<a.photonum&&q.find(a.clicktag+":eq("+g+")").trigger(a.setevent)});b(a.prevdiv).bind(a.setevent,function(){g>1&&q.find(a.clicktag+":eq("+(g-2)+")").trigger(a.setevent)});b(this).find(a.clicktag).each(function(){b(this).bind(a.setevent,function(){var e=b(this);g=b(this).children("span").text();var c=Math.ceil(g/a.perphotos);c!=
j&&h(c);c=b(this).parents(a.parentdiv).find(a.itemsid+g);c.siblings().stop(!0,!0).fadeOut(a.fadeinspeed);c.stop(!0,!0).fadeIn(a.fadeoutspeed).setHeight();g>1?b(a.prevdiv).show("fast",function(){var a=e.parent().prev().children().attr("href");b(this).attr("href",a)}):b(a.prevdiv).hide();g<a.photonum?b(a.nextdiv).show("fast",function(){var a=e.parent().next().children().attr("href");b(this).attr("href",a)}):b(a.nextdiv).hide();b(this).addClass(a.activeclass).parent().siblings().children().removeClass(a.activeclass)})});
b(this).find(a.clicktag+":eq("+(a.defphoto-1)+")").trigger(a.setevent)})};b.fn.setHeight=function(){return this.each(function(){var e=b(this);b(this).parent().stop(!0,!0).animate({height:e.height()});b(".photo_prev, .photo_next").height(e.find(".photo_show").height())})}})(jQuery);